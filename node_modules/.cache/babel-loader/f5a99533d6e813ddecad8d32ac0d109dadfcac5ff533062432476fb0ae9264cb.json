{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useAppContext } from '../context/AppContext';\nimport { languages } from '../utils/translations';\nlet isSpeaking = false; // Global flag to prevent multiple calls\n\nexport const useVoiceGuidance = () => {\n  _s();\n  const {\n    voiceEnabled,\n    selectedLanguage\n  } = useAppContext();\n  const speak = text => {\n    if (!voiceEnabled || !('speechSynthesis' in window)) return;\n    if (isSpeaking) return; // Prevent if already speaking\n\n    isSpeaking = true;\n    window.speechSynthesis.cancel();\n    const utterance = new SpeechSynthesisUtterance(text);\n    const langObj = languages.find(l => l.code === selectedLanguage);\n    utterance.lang = (langObj === null || langObj === void 0 ? void 0 : langObj.voiceLang) || 'en-US';\n    utterance.rate = 0.9;\n    utterance.pitch = 1.1;\n    utterance.volume = 1.0;\n    const voices = window.speechSynthesis.getVoices();\n    let bestVoice = voices.find(v => v.lang === (langObj === null || langObj === void 0 ? void 0 : langObj.voiceLang) && v.localService === false);\n    if (!bestVoice) {\n      bestVoice = voices.find(v => v.lang.startsWith(langObj === null || langObj === void 0 ? void 0 : langObj.voiceLang.split('-')[0]));\n    }\n    if (bestVoice) {\n      utterance.voice = bestVoice;\n    }\n\n    // Reset flag when speech ends\n    utterance.onend = () => {\n      isSpeaking = false;\n    };\n    utterance.onerror = () => {\n      isSpeaking = false;\n    };\n    window.speechSynthesis.speak(utterance);\n  };\n  return {\n    speak\n  };\n};\n_s(useVoiceGuidance, \"eaNcdHSYPIYRj7iEdDc5cnYmDAg=\", false, function () {\n  return [useAppContext];\n});","map":{"version":3,"names":["useAppContext","languages","isSpeaking","useVoiceGuidance","_s","voiceEnabled","selectedLanguage","speak","text","window","speechSynthesis","cancel","utterance","SpeechSynthesisUtterance","langObj","find","l","code","lang","voiceLang","rate","pitch","volume","voices","getVoices","bestVoice","v","localService","startsWith","split","voice","onend","onerror"],"sources":["/home/sarika/krishiii/src/components/VoiceGuidance.js"],"sourcesContent":["import { useAppContext } from '../context/AppContext';\r\nimport { languages } from '../utils/translations';\r\n\r\nlet isSpeaking = false; // Global flag to prevent multiple calls\r\n\r\nexport const useVoiceGuidance = () => {\r\n  const { voiceEnabled, selectedLanguage } = useAppContext();\r\n\r\n  const speak = (text) => {\r\n    if (!voiceEnabled || !('speechSynthesis' in window)) return;\r\n    if (isSpeaking) return; // Prevent if already speaking\r\n    \r\n    isSpeaking = true;\r\n    window.speechSynthesis.cancel();\r\n    \r\n    const utterance = new SpeechSynthesisUtterance(text);\r\n    const langObj = languages.find(l => l.code === selectedLanguage);\r\n    utterance.lang = langObj?.voiceLang || 'en-US';\r\n    \r\n    utterance.rate = 0.9;\r\n    utterance.pitch = 1.1;\r\n    utterance.volume = 1.0;\r\n    \r\n    const voices = window.speechSynthesis.getVoices();\r\n    let bestVoice = voices.find(v => \r\n      v.lang === langObj?.voiceLang && v.localService === false\r\n    );\r\n    \r\n    if (!bestVoice) {\r\n      bestVoice = voices.find(v => v.lang.startsWith(langObj?.voiceLang.split('-')[0]));\r\n    }\r\n    \r\n    if (bestVoice) {\r\n      utterance.voice = bestVoice;\r\n    }\r\n    \r\n    // Reset flag when speech ends\r\n    utterance.onend = () => {\r\n      isSpeaking = false;\r\n    };\r\n    \r\n    utterance.onerror = () => {\r\n      isSpeaking = false;\r\n    };\r\n    \r\n    window.speechSynthesis.speak(utterance);\r\n  };\r\n\r\n  return { speak };\r\n};"],"mappings":";AAAA,SAASA,aAAa,QAAQ,uBAAuB;AACrD,SAASC,SAAS,QAAQ,uBAAuB;AAEjD,IAAIC,UAAU,GAAG,KAAK,CAAC,CAAC;;AAExB,OAAO,MAAMC,gBAAgB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACpC,MAAM;IAAEC,YAAY;IAAEC;EAAiB,CAAC,GAAGN,aAAa,CAAC,CAAC;EAE1D,MAAMO,KAAK,GAAIC,IAAI,IAAK;IACtB,IAAI,CAACH,YAAY,IAAI,EAAE,iBAAiB,IAAII,MAAM,CAAC,EAAE;IACrD,IAAIP,UAAU,EAAE,OAAO,CAAC;;IAExBA,UAAU,GAAG,IAAI;IACjBO,MAAM,CAACC,eAAe,CAACC,MAAM,CAAC,CAAC;IAE/B,MAAMC,SAAS,GAAG,IAAIC,wBAAwB,CAACL,IAAI,CAAC;IACpD,MAAMM,OAAO,GAAGb,SAAS,CAACc,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,IAAI,KAAKX,gBAAgB,CAAC;IAChEM,SAAS,CAACM,IAAI,GAAG,CAAAJ,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEK,SAAS,KAAI,OAAO;IAE9CP,SAAS,CAACQ,IAAI,GAAG,GAAG;IACpBR,SAAS,CAACS,KAAK,GAAG,GAAG;IACrBT,SAAS,CAACU,MAAM,GAAG,GAAG;IAEtB,MAAMC,MAAM,GAAGd,MAAM,CAACC,eAAe,CAACc,SAAS,CAAC,CAAC;IACjD,IAAIC,SAAS,GAAGF,MAAM,CAACR,IAAI,CAACW,CAAC,IAC3BA,CAAC,CAACR,IAAI,MAAKJ,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEK,SAAS,KAAIO,CAAC,CAACC,YAAY,KAAK,KACtD,CAAC;IAED,IAAI,CAACF,SAAS,EAAE;MACdA,SAAS,GAAGF,MAAM,CAACR,IAAI,CAACW,CAAC,IAAIA,CAAC,CAACR,IAAI,CAACU,UAAU,CAACd,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEK,SAAS,CAACU,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACnF;IAEA,IAAIJ,SAAS,EAAE;MACbb,SAAS,CAACkB,KAAK,GAAGL,SAAS;IAC7B;;IAEA;IACAb,SAAS,CAACmB,KAAK,GAAG,MAAM;MACtB7B,UAAU,GAAG,KAAK;IACpB,CAAC;IAEDU,SAAS,CAACoB,OAAO,GAAG,MAAM;MACxB9B,UAAU,GAAG,KAAK;IACpB,CAAC;IAEDO,MAAM,CAACC,eAAe,CAACH,KAAK,CAACK,SAAS,CAAC;EACzC,CAAC;EAED,OAAO;IAAEL;EAAM,CAAC;AAClB,CAAC;AAACH,EAAA,CA5CWD,gBAAgB;EAAA,QACgBH,aAAa;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}